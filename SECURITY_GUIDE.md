# Security System Guide / –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —Å–∏—Å—Ç–µ–º–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

## Overview / –û–±–∑–æ—Ä

This security system provides comprehensive protection against web attacks, scanners, and malicious actors. The system includes IP blocking, rate limiting, threat detection, and real-time monitoring.

–≠—Ç–∞ —Å–∏—Å—Ç–µ–º–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –∫–æ–º–ø–ª–µ–∫—Å–Ω—É—é –∑–∞—â–∏—Ç—É –æ—Ç –≤–µ–±-–∞—Ç–∞–∫, —Å–∫–∞–Ω–µ—Ä–æ–≤ –∏ –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫–æ–≤. –°–∏—Å—Ç–µ–º–∞ –≤–∫–ª—é—á–∞–µ—Ç –±–ª–æ–∫–∏—Ä–æ–≤–∫—É IP, –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Å–∫–æ—Ä–æ—Å—Ç–∏, –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ —É–≥—Ä–æ–∑ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏.

## Features / –§—É–Ω–∫—Ü–∏–∏

### üîí IP Blocking / –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ IP
- Automatic blocking of suspicious IPs
- Configurable block duration
- Manual IP management
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö IP-–∞–¥—Ä–µ—Å–æ–≤
- –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º–∞—è –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏
- –†—É—á–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ IP-–∞–¥—Ä–µ—Å–∞–º–∏

### ‚ö° Rate Limiting / –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Å–∫–æ—Ä–æ—Å—Ç–∏
- Request rate limiting per IP
- Burst protection
- Configurable thresholds
- –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Å–∫–æ—Ä–æ—Å—Ç–∏ –∑–∞–ø—Ä–æ—Å–æ–≤ –Ω–∞ IP
- –ó–∞—â–∏—Ç–∞ –æ—Ç –≤—Å–ø–ª–µ—Å–∫–æ–≤ —Ç—Ä–∞—Ñ–∏–∫–∞
- –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–µ –ø–æ—Ä–æ–≥–∏

### üö® Threat Detection / –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ —É–≥—Ä–æ–∑
- Suspicious path detection
- SQL injection detection
- XSS attack detection
- Directory traversal detection
- –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö –ø—É—Ç–µ–π
- –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ SQL-–∏–Ω—ä–µ–∫—Ü–∏–π
- –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ XSS-–∞—Ç–∞–∫
- –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –æ–±—Ö–æ–¥–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π

### üìä Monitoring & Logging / –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- Real-time attack monitoring
- Detailed logging
- Attack pattern analysis
- Threat scoring
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∞—Ç–∞–∫ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
- –î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- –ê–Ω–∞–ª–∏–∑ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ –∞—Ç–∞–∫
- –û—Ü–µ–Ω–∫–∞ —É—Ä–æ–≤–Ω—è —É–≥—Ä–æ–∑

## Configuration / –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### Security Settings / –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

Edit `app/config.py` to modify security settings:

```python
SECURITY_CONFIG = {
    "ip_blocking": {
        "enabled": True,
        "block_duration": 3600,  # 1 hour in seconds
        "auto_block_suspicious": True,
    },
    "rate_limiting": {
        "enabled": True,
        "max_requests_per_minute": 100,
        "burst_max_requests": 50,
    },
    # ... more settings
}
```

### Suspicious Patterns / –ü–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã

The system detects common attack patterns:

- **Paths**: `.env`, `.git/config`, `admin/config.php`, `phpinfo.php`, etc.
- **Extensions**: `.bak`, `.old`, `.sql`, `.env`, etc.
- **Parameters**: `cmd`, `exec`, `union select`, `script`, etc.

## API Endpoints / API –≠–Ω–¥–ø–æ–∏–Ω—Ç—ã

### Security Statistics / –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
```
GET /security/stats
```
Returns current security statistics and configuration.

### Monitoring Statistics / –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
```
GET /monitoring/stats
```
Returns attack monitoring statistics.

### Attack Analysis / –ê–Ω–∞–ª–∏–∑ –∞—Ç–∞–∫
```
GET /monitoring/analysis?time_window_hours=24
```
Returns attack pattern analysis for specified time window.

### High Threat IPs / IP —Å –≤—ã—Å–æ–∫–∏–º–∏ —É–≥—Ä–æ–∑–∞–º–∏
```
GET /monitoring/high-threat-ips?threshold=10
```
Returns IP addresses with high threat scores.

## Command Line Interface / –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏

### Security Status / –°—Ç–∞—Ç—É—Å –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
```bash
python app/security_manager.py status
```

### Attack Analysis / –ê–Ω–∞–ª–∏–∑ –∞—Ç–∞–∫
```bash
python app/security_manager.py analysis --hours 24
```

### High Threat IPs / IP —Å –≤—ã—Å–æ–∫–∏–º–∏ —É–≥—Ä–æ–∑–∞–º–∏
```bash
python app/security_manager.py threats --threshold 10
```

### Real-time Monitoring / –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
```bash
python app/security_manager.py monitor --interval 5
```

### Export Logs / –≠–∫—Å–ø–æ—Ä—Ç –ª–æ–≥–æ–≤
```bash
python app/security_manager.py export security_logs.json --days 7
```

## Log Files / –§–∞–π–ª—ã –ª–æ–≥–æ–≤

The system creates three types of log files:

- `attacks_YYYYMMDD.json` - Detailed attack logs
- `blocked_YYYYMMDD.json` - Blocked request logs
- `suspicious_YYYYMMDD.json` - Suspicious activity logs

Logs are rotated daily and kept for 7 days by default.

## Common Attack Patterns / –û–±—â–∏–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã –∞—Ç–∞–∫

### Scanning & Probing / –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –∑–æ–Ω–¥–∏—Ä–æ–≤–∞–Ω–∏–µ
- Requests to common vulnerable paths
- Directory listing attempts
- Configuration file access
- –ó–∞–ø—Ä–æ—Å—ã –∫ –æ–±—â–∏–º —É—è–∑–≤–∏–º—ã–º –ø—É—Ç—è–º
- –ü–æ–ø—ã—Ç–∫–∏ –ª–∏—Å—Ç–∏–Ω–≥–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π
- –î–æ—Å—Ç—É–ø –∫ —Ñ–∞–π–ª–∞–º –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

### Information Disclosure / –†–∞—Å–∫—Ä—ã—Ç–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏
- Access to `.env` files
- Git repository access
- Database dumps
- Backup files
- –î–æ—Å—Ç—É–ø –∫ —Ñ–∞–π–ª–∞–º `.env`
- –î–æ—Å—Ç—É–ø –∫ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—é Git
- –î–∞–º–ø—ã –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö
- –§–∞–π–ª—ã —Ä–µ–∑–µ—Ä–≤–Ω—ã—Ö –∫–æ–ø–∏–π

### Injection Attacks / –ê—Ç–∞–∫–∏ –∏–Ω—ä–µ–∫—Ü–∏–π
- SQL injection attempts
- Command injection
- File inclusion
- –ü–æ–ø—ã—Ç–∫–∏ SQL-–∏–Ω—ä–µ–∫—Ü–∏–π
- –ò–Ω—ä–µ–∫—Ü–∏–∏ –∫–æ–º–∞–Ω–¥
- –í–∫–ª—é—á–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤

## Best Practices / –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### Regular Monitoring / –†–µ–≥—É–ª—è—Ä–Ω—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
1. Check security status daily
2. Review high threat IPs weekly
3. Analyze attack patterns monthly
4. Export and archive logs regularly

1. –ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ —Å—Ç–∞—Ç—É—Å –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –µ–∂–µ–¥–Ω–µ–≤–Ω–æ
2. –ü—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞–π—Ç–µ IP —Å –≤—ã—Å–æ–∫–∏–º–∏ —É–≥—Ä–æ–∑–∞–º–∏ –µ–∂–µ–Ω–µ–¥–µ–ª—å–Ω–æ
3. –ê–Ω–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã –∞—Ç–∞–∫ –µ–∂–µ–º–µ—Å—è—á–Ω–æ
4. –†–µ–≥—É–ª—è—Ä–Ω–æ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ –∏ –∞—Ä—Ö–∏–≤–∏—Ä—É–π—Ç–µ –ª–æ–≥–∏

### Configuration Tuning / –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- Adjust rate limits based on normal traffic patterns
- Update suspicious patterns as new threats emerge
- Configure appropriate block durations
- –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è —Å–∫–æ—Ä–æ—Å—Ç–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ –Ω–æ—Ä–º–∞–ª—å–Ω—ã—Ö –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ —Ç—Ä–∞—Ñ–∏–∫–∞
- –û–±–Ω–æ–≤–ª—è–π—Ç–µ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã –ø–æ –º–µ—Ä–µ –ø–æ—è–≤–ª–µ–Ω–∏—è –Ω–æ–≤—ã—Ö —É–≥—Ä–æ–∑
- –ù–∞—Å—Ç—Ä–æ–π—Ç–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â—É—é –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏

### Incident Response / –†–µ–∞–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ –∏–Ω—Ü–∏–¥–µ–Ω—Ç—ã
1. Identify the attack type and source
2. Check if IP is already blocked
3. Review logs for similar patterns
4. Consider permanent blocking for repeat offenders
5. Update security patterns if necessary

1. –û–ø—Ä–µ–¥–µ–ª–∏—Ç–µ —Ç–∏–ø –∞—Ç–∞–∫–∏ –∏ –∏—Å—Ç–æ—á–Ω–∏–∫
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω –ª–∏ IP
3. –ü—Ä–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –ª–æ–≥–∏ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –ø–æ—Ö–æ–∂–∏—Ö –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤
4. –†–∞—Å—Å–º–æ—Ç—Ä–∏—Ç–µ –ø–æ—Å—Ç–æ—è–Ω–Ω—É—é –±–ª–æ–∫–∏—Ä–æ–≤–∫—É –¥–ª—è –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –Ω–∞—Ä—É—à–∏—Ç–µ–ª–µ–π
5. –ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –æ–±–Ω–æ–≤–∏—Ç–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

## Troubleshooting / –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫

### Common Issues / –û–±—â–∏–µ –ø—Ä–æ–±–ª–µ–º—ã

**False Positives / –õ–æ–∂–Ω—ã–µ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏—è**
- Adjust suspicious pattern thresholds
- Add legitimate paths to whitelist
- Review and tune detection rules

**Performance Impact / –í–ª–∏—è–Ω–∏–µ –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**
- Optimize rate limiting settings
- Reduce log verbosity if needed
- Monitor system resources

**Connection Issues / –ü—Ä–æ–±–ª–µ–º—ã —Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ–º**
- Verify service is running
- Check firewall settings
- Validate API endpoints

## Security Modules / –ú–æ–¥—É–ª–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### `security.py`
- IP blocking and rate limiting
- Threat detection and analysis
- Security middleware

### `monitoring.py`
- Attack logging and analysis
- Threat scoring
- Real-time monitoring

### `config.py`
- Security configuration
- Suspicious patterns
- Feature flags

### `security_manager.py`
- Command-line interface
- Log management
- Real-time monitoring

## Support / –ü–æ–¥–¥–µ—Ä–∂–∫–∞

For security issues or questions:
- Review logs in `logs/` directory
- Check security statistics via API
- Use CLI tools for analysis
- Contact system administrator

–î–ª—è –≤–æ–ø—Ä–æ—Å–æ–≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏:
- –ü—Ä–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –ª–æ–≥–∏ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ `logs/`
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ —á–µ—Ä–µ–∑ API
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã CLI –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞
- –û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ —Å–∏—Å—Ç–µ–º–Ω–æ–º—É –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É

---

**Note**: This security system is designed to protect against common web attacks but should be used as part of a comprehensive security strategy.

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ**: –≠—Ç–∞ —Å–∏—Å—Ç–µ–º–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–∞ –¥–ª—è –∑–∞—â–∏—Ç—ã –æ—Ç —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–Ω—ã—Ö –≤–µ–±-–∞—Ç–∞–∫, –Ω–æ –¥–æ–ª–∂–Ω–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –∫–∞–∫ —á–∞—Å—Ç—å –∫–æ–º–ø–ª–µ–∫—Å–Ω–æ–π —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏.